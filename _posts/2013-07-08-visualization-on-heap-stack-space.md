---
layout : post
comments: true
weibo: 2318464877
image : https://dl.dropboxusercontent.com/u/161895058/blog/musicdownloader.png
summary : "这篇文章将将主要和大家探讨下内存堆栈的数据视觉化问题"
title : "堆栈内存空间的数据视觉化"
---

***
>扫除概念



那首先，先解决下概念性的问题，什么是堆？ 什么是栈 ？ 确切的说应该是 内存“堆空间 和 “栈空间”，写过c++、java的程序员对这个概念一定不陌生。在很多语言中，基础变量类型 比如 "数字，字符串，布尔，浮点”在声明的时候
都会被放到“栈空间”，而 “对象，数组,函数” 等引用类型变量会被放到“堆空间” 同时 还会在 “栈空间” 存储 指向该 “对象”的 “引用”。那通过上面这个概念的阐述，相信你一定会感到 “堆空间” 是要比 “栈空间” 大的（请看图），那以javascript 为例来说明


***
>例子

1.“栈空间例子”：



```
var a = "hello"； 
a = 2 ; 
```

* 内存中的变化过程是：
  * 将 a  存储到 “栈空间”, 值为 "hello"
  * "变量a" 在“栈空间”的值 从“hello” 变成 2


![](https://dl.dropboxusercontent.com/u/161895058/blog/s1.png)


2.“堆空间例子”：

```
var obj = { name : "Jonathan" };
obj = {name : "River" };
```


* 内存中的变化过程是：
   * 首先 在 “堆” 中 创建 一个 {name:"Jonathan"} 的对象，
   * 然后在 “栈” 中 创建 变量 obj, 
   * 最后将 obj 指向 “堆” 中的 {name:"Jonathan"}.换句话说，obj 中存储的值是 {name :"Jonathan"} 在“堆”中的地址;
   * 在“堆”中 创建一个新对象 {name:"River"}, 改变obj的指针，将值 更新为 {name : "River"} 在“堆”中的地址；

![](https://dl.dropboxusercontent.com/u/161895058/blog/s2.png)

***
>区别

* “栈空间” 往往发生值的变化
* “堆空间” 往往发生引用的变化

***
>演示 - “堆栈数据视觉化”

堆栈空间视觉化，是为了以真实可见的形式，动态展示内存空间的变化，那有了她做为基础后呢，我们可以在上面构建我们的业务逻辑，进而来反映动态反映“业务数据的视觉化”，比如“微博关系分析，交通情况实时动态分析，基于数据库的、搜索引擎的数据分析等等”，
简单的说，按照分层的思想，“堆栈内存空间的视觉化” 是 “业务数据视觉化” 的底层 ， “业务数据视觉化” 是应用层的简单封装。那通过下面的展示,感受一下什么是“堆栈视觉化”

* 数组是大家最熟悉的数据结构，那我们以一个初始状态为空的数组为例


```
var exp = [];
```

* 当你点击按钮data-1..data-5的，将会发生如下变化数据变化
  * [1,2,3,4]
  * [1,2,3,4,5]
  * [5,4,3,2,1]
  * [9,8,7,6,1,2]
  * [6,2,12,34,1,3,56]
* 堆栈内存空间又将发生什么样的变化呢？
 * 我用红绿蓝3色 标注了 每次内存变化，增改删的元素，
 * 因为数组是一个“引用数据类型”，所以每次发生数据变化的时候，并不是“值”的改变，而是“指针”在变化，堆栈内不存在要指向的数据的时候，才去创建，否则只是改变存储的地址
 * 你将会发现，很多数据都被“重用”了（绿色的数据，就是被重用的数据）,那这样一来，原本靠想象的内存变化过错，便呈现在眼前。

<iframe class="movie" style="height:660px;margin-top: 40px;" src="/assets/demos/d1/index.html" frameborder=0 allowfullscreen></iframe>


***
>演示 - "业务数据视觉化"



* “业务数据视觉化”只是在“堆栈数据视觉化”的基础上，做简单业务逻辑的封装,那这里我以线图和柱状图为例向大家展示




comming soon..
